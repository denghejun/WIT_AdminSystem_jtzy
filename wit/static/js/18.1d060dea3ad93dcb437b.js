webpackJsonp([18],{"7seh":function(t,e){},FRGb:function(t,e){},Uke6:function(t,e){},XKiL:function(t,e,a){"use strict";(function(t){e.a={name:"trend-table",data:function(){return{table:[{date:"2020-01-01",total:"10000",current:"1000"},{date:"2020-01-02",total:"10000",current:"1000"},{date:"2020-01-03",total:"10000",current:"1000"},{date:"2020-01-04",total:"10000",current:"1000"},{date:"2020-01-05",total:"10000",current:"1000"},{date:"2020-01-06",total:"10000",current:"1000"},{date:"2020-01-06",total:"10000",current:"1000"},{date:"2020-01-06",total:"10000",current:"1000"}]}},created:function(){this.table=this.tableData},props:{tableData:{type:Array}},computed:{columnWidth:function(){return(t(document).width()-200)/this.table.length+"px"}}}}).call(e,a("7t+N"))},drAE:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("h9gA"),n={name:"trend-date",data:function(){return{index:"1",radio:1,type:0}},mounted:function(){this.firstCommand("")},methods:{firstCommand:function(t){var e=new Date,a=new Date(e.getTime()-63072e6);e=this.format(e,1),a=this.format(a,1),this.$emit("searchTimes",{start:a,end:e,type:1})},secondCommand:function(t){var e=new Date,a=void 0;switch(t){case"1":a=new Date(e.getTime()-128736e5);break;case"2":a=new Date(e.getTime()-232416e5);break;case"3":a=new Date(e.getTime()-336096e5)}a=this.format(a,2),e=this.format(e,2),this.$emit("searchTimes",{start:a,end:e,type:2})},thirdCommand:function(t){var e=new Date,a=void 0;switch(t){case"1":a=new Date(e.getTime()-65664e5);break;case"2":a=new Date(e.getTime()-126144e5);break;case"3":a=new Date(e.getTime()-247104e5)}a=this.format(a,2),e=this.format(e,2),this.$emit("searchTimes",{start:a,end:e,type:3})},link:function(t){if(t!=this.type)switch(this.type=t,this.radio=t,this.type){case 1:this.firstCommand("");break;case 2:this.secondCommand("1");break;case 3:this.thirdCommand("1")}},format:function(t,e){var a=(t=new Date(t)).getFullYear(),i=t.getMonth()+1;i=i<10?"0"+i:i;var n=t.getDate();switch(n=n<10?"0"+n:n,e){case 1:t=a+"-"+i;break;case 2:t=a+"-"+i+"-"+n}return t}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"select-date"},[a("el-dropdown",{attrs:{trigger:"click"},on:{command:t.firstCommand}},[a("el-button",{attrs:{type:1==t.radio?"primary":"normal",size:"mini"},on:{click:function(e){return t.link(1)}}},[t._v("\n      连续12个月年用水趋势分析")])],1),t._v(" "),a("el-dropdown",{attrs:{trigger:"click"},on:{command:t.secondCommand}},[a("el-button",{attrs:{type:2==t.radio?"primary":"normal",size:"mini"},on:{click:function(e){return t.link(2)}}},[t._v("\n      连续30日月用水趋势分析"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"1"}},[t._v("前推120天")]),t._v(" "),a("el-dropdown-item",{attrs:{command:"2"}},[t._v("前推240天")]),t._v(" "),a("el-dropdown-item",{attrs:{command:"3"}},[t._v("前推360天")])],1)],1),t._v(" "),a("el-dropdown",{attrs:{trigger:"click"},on:{command:t.thirdCommand}},[a("el-button",{attrs:{type:3==t.radio?"primary":"normal",size:"mini"},on:{click:function(e){return t.link(3)}}},[t._v("\n      连续7日周用水趋势分析"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"1"}},[t._v("前推70天")]),t._v(" "),a("el-dropdown-item",{attrs:{command:"2"}},[t._v("前推140天")]),t._v(" "),a("el-dropdown-item",{attrs:{command:"3"}},[t._v("前推280天")])],1)],1)],1)},staticRenderFns:[]};var s=a("VU/8")(n,r,!1,function(t){a("Uke6")},"data-v-7ea1ffaa",null).exports,o=a("XLwt"),d={name:"trend-chart",data:function(){return{options:{title:{text:"",x:"center"},color:["#5B9BD5","#ED7D31"],tooltip:{trigger:"axis"},toolbox:{show:!0,right:30,top:"10px",feature:{mark:{show:!0},magicType:{show:!0,type:["line","bar"]},saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:"月",axisTick:{show:!1},boundaryGap:!1,data:["2014","2015","2016","2017","2018"]}],grid:{left:"2%",right:"4%",bottom:"0%",containLabel:!0},yAxis:[{name:"水量（吨）",type:"value"}],series:[{name:"用水量",type:"line",smooth:!0,symbol:"none",sampling:"average",itemStyle:{color:"rgb(255, 70, 131)"},data:[80,150,301,150,60],areaStyle:{color:new o.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgb(0, 0, 255)"},{offset:1,color:"rgb(193, 210, 240)"}])}}]}}},props:{xData:{tyep:Array},yData:{type:Array}},mounted:function(){this.getChartData()},methods:{init:function(){o.init(this.$refs.div).setOption(this.options,!0)},compare:function(t){return function(e,a){return e[t]-a[t]}},setColor:function(){var t=this.options.series[2].data;for(var e in t)parseInt(e.value)<0&&(e.itemStyle=e.itemStyle||{},e.itemStyle={normal:{color:"#ff5965"}})},getChartData:function(){this.options.series[0].data=this.yData,this.options.xAxis[0].data=this.xData,this.init()}}},c={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{height:"100%"}},[e("div",{ref:"div",staticStyle:{height:"100%",width:"100%"},attrs:{id:"savingChart"}})])},staticRenderFns:[]};var l=a("VU/8")(d,c,!1,function(t){a("oHL0")},"data-v-09e46e9d",null).exports,m=a("XKiL"),u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"water-table"},[a("div",{staticClass:"first-column",style:{width:t.columnWidth}},[a("div",{staticClass:"first-column-row"},[t._v("时间")]),t._v(" "),a("div",{staticClass:"first-column-row"},[t._v("统计水量(吨)")]),t._v(" "),a("div",{staticClass:"first-column-row"},[t._v("当前水量(吨)")])]),t._v(" "),t._l(t.table,function(e,i){return a("div",{key:i,staticClass:"middle-column",style:{width:t.columnWidth}},[a("div",{staticClass:"middle-column-row"},[t._v(t._s(e.date))]),t._v(" "),a("div",{staticClass:"middle-column-row"},[t._v(t._s(e.total))]),t._v(" "),a("div",{staticClass:"middle-column-row"},[t._v(t._s(e.current))])])}),t._v(" "),t._l(14-t.table.length<0?0:14-t.table.length,function(e){return t.table.length<14?a("div",{staticClass:"middle-column",style:{width:t.columnWidth}},[a("div",{staticClass:"middle-column-row"}),t._v(" "),a("div",{staticClass:"middle-column-row"}),t._v(" "),a("div",{staticClass:"middle-column-row"})]):t._e()})],2)},staticRenderFns:[]};var h=function(t){a("FRGb")},p=a("VU/8")(m.a,u,!1,h,"data-v-35b45f6a",null).exports,v=a("mF0L"),f={components:{TrendTable:p,TrendChart:l,TrendDate:s,SelectCampus:i.a},name:"water-use-trend-analysis",data:function(){return{regionId:1,type:1,start:"",end:"",xData:[],yData:[],xName:[],show:!1,tableData:[],columns:[{name:"时间",prop:"date"},{name:"统计水量(吨)",prop:"total"},{name:"当前水量(吨)",prop:"current"}],title:"用水趋势分析报表"}},methods:{changeCampus:function(t){this.show=!1,this.regionId=t.id,this.getDataByType()},searchTimes:function(t){this.show=!1,this.start=t.start,this.end=t.end,this.type=t.type,this.getDataByType()},getDataByType:function(){1==this.type?(this.xName="月",this.getMonthData()):2==this.type?(this.xName="日",this.getDayData()):3==this.type&&(this.xName="日",this.getWeekData())},getWeekData:function(){var t=this,e={pageNum:1,pageSize:1e3,waterregionid:this.regionId,starttime:this.start,endtime:this.end},a=0,i=7,n=[],r=[],s=[];this.$api.regionData.findTimesDayFlow(e).then(function(e){var o=e.data.list;if(o instanceof Array&&o.length>0){if(!((o=o.filter(function(t){return 0!=t.data})).length>7))return void t.$alert("提示","数据太少！");var d,c=o.slice(a,i),l=0;c.forEach(function(t){l+=Number(t.data)}),d=c[c.length-1],s.push({date:d.time,total:Number(l).toFixed(0),current:Number(Number(d.data).toFixed(0))}),n.push(d.time),r.push(l);for(var m=i;m<o.length;m++)l=Number(Number(l)-Number(o[a].data)+Number(o[i].data)).toFixed(0),n.push(o[i].time),r.push(l),s.push({date:o[i].time,total:Number(l).toFixed(0),current:Number(Number(o[i].data).toFixed(0))}),a++,i++;t.tableData=s,t.xData=n,t.yData=r,t.show=!0}})},getDayData:function(){var t=this,e={pageNum:1,pageSize:1e3,waterregionid:this.regionId,starttime:this.start,endtime:this.end},a=0,i=30,n=[],r=[],s=[];this.$api.regionData.findTimesDayFlow(e).then(function(e){var o=e.data.list;if(o instanceof Array&&o.length>0){if(!((o=o.filter(function(t){return 0!=t.data})).length>30))return void t.$alert("提示","数据太少！");var d,c=o.slice(a,i),l=0;c.forEach(function(t){l+=Number(t.data)}),d=c[c.length-1],s.push({date:d.time,total:Number(l).toFixed(0),current:Number(Number(d.data).toFixed(0))}),n.push(d.time),r.push(l);for(var m=i;m<o.length;m++)l=Number(Number(l)-Number(o[a].data)+Number(o[i].data)).toFixed(0),n.push(o[i].time),r.push(l),s.push({date:o[i].time,total:Number(l).toFixed(0),current:Number(Number(o[i].data).toFixed(0))}),a++,i++;t.tableData=s,t.xData=n,t.yData=r,t.show=!0}})},getMonthData:function(){var t=this,e={pageNum:1,pageSize:1e3,waterregionid:this.regionId,starttime:this.start,endtime:this.end},a=0,i=12,n=[],r=[],s=[];this.$api.regionData.findTimesMonthFlow(e).then(function(e){var o=e.data.list;if(o instanceof Array&&o.length>0){if(!((o=o.filter(function(t){return 0!=t.data})).length>12))return void t.$alert("提示","数据太少！");var d,c=o.slice(a,i),l=0;c.forEach(function(t){l+=Number(t.data)}),d=c[c.length-1],s.push({date:d.time,total:Number(l).toFixed(0),current:Number(Number(d.data).toFixed(0))}),n.push(d.time),r.push(l);for(var m=i;m<o.length;m++)l=Number(Number(l)-Number(o[a].data)+Number(o[i].data)).toFixed(0),n.push(o[i].time),r.push(l),s.push({date:o[i].time,total:Number(l).toFixed(0),current:Number(Number(o[i].data).toFixed(0))}),a++,i++;t.tableData=s,t.xData=n,t.yData=r,t.show=!0}})},exportData:function(){Object(v.a)(this.columns,this.tableData,this.title)}}},g={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"flex"},[a("div",{staticClass:"content body"},[a("div",{staticClass:" box box-solid"},[a("div",{staticClass:"box-header bg-aqua"},[t._v("用水趋势分析")]),t._v(" "),a("div",{staticClass:"box-body"},[a("div",{staticClass:"select-date"},[a("select-campus",{attrs:{regionId:t.regionId},on:{change:t.changeCampus}}),t._v(" "),a("trend-date",{staticClass:"trend-date",on:{searchTimes:t.searchTimes}}),t._v(" "),a("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-download"},on:{click:t.exportData}},[t._v("导出")])],1),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:!t.show,expression:"!show"}],staticClass:"trend-chart"},[t.show?a("trend-chart",{attrs:{xData:t.xData,yData:t.yData}}):t._e()],1),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:!t.show,expression:"!show"}],staticClass:"trend-table"},[t.show?a("trend-table",{attrs:{tableData:t.tableData}}):t._e()],1)])])])])},staticRenderFns:[]};var b=a("VU/8")(f,g,!1,function(t){a("7seh")},"data-v-2b2cd614",null);e.default=b.exports},oHL0:function(t,e){}});
//# sourceMappingURL=18.1d060dea3ad93dcb437b.js.map