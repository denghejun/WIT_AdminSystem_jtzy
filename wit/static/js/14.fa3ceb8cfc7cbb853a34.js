webpackJsonp([14],{DUeF:function(e,t){},FtYB:function(e,t){},k1s1:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={name:"time-frame",data:function(){return{pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},value:""}},methods:{searchByTimes:function(){}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"block"},[a("b",[e._v("时间区段：")]),e._v(" "),a("el-date-picker",{attrs:{type:"daterange",size:"small",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}),e._v(" "),a("el-button",{attrs:{slot:"append",size:"small",icon:"el-icon-search"},on:{click:e.searchByTimes},slot:"append"},[a("b",[e._v("查询")])])],1)},staticRenderFns:[]};var l=a("VU/8")(s,r,!1,function(e){a("mTZ3")},"data-v-4b25b72a",null).exports,i={name:"select-alarm-type",data:function(){return{radio:"1"}},props:{type:{type:String,default:""}},watch:{type:{handler:function(e,t){this.radio=e}}},methods:{change:function(){var e={type:""};switch(this.radio){case"1":e.type="";break;case"2":e.type="40";break;case"3":e.type="30";break;case"4":e.type="20";break;case"5":e.type="10";break;default:e.type="50"}this.$emit("changeType",e)}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-radio-group",{attrs:{size:"small",fill:"#67C23A"},on:{change:e.change},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[a("el-radio-button",{attrs:{label:"1"}},[e._v("全部")]),e._v(" "),a("el-radio-button",{attrs:{label:"2"}},[e._v("校区漏损")]),e._v(" "),a("el-radio-button",{attrs:{label:"3"}},[e._v("DMA漏损")]),e._v(" "),a("el-radio-button",{attrs:{label:"4"}},[e._v("建筑漏损")]),e._v(" "),a("el-radio-button",{attrs:{label:"5"}},[e._v("表具漏损")]),e._v(" "),a("el-radio-button",{attrs:{label:"6"}},[e._v("设备故障")])],1)},staticRenderFns:[]};var n=a("VU/8")(i,o,!1,function(e){a("qaaU")},"data-v-5abe4010",null).exports,c={name:"select-times",data:function(){return{radio:"3",value:""}},created:function(){this.change()},methods:{changeTimes:function(){var e=this.value;this.$emit("changeTimes",{start:e[0],end:e[1]})},change:function(){var e=new Date,t=e.getTime();switch(this.radio){case"1":t=new Date(t-864e5);break;case"2":t=new Date(t-1728e5);break;case"3":t=new Date(t-2592e5)}this.$emit("changeTimes",{start:this.format(t),end:this.format(e)})},format:function(e){var t=(e=new Date(e)).getFullYear(),a=e.getMonth()+1;a=a<10?"0"+a:a;var s=e.getDate();s=s<10?"0"+s:s;var r=e.getHours();r=r<10?"0"+r:r;var l=e.getMinutes();l=l<10?"0"+l:l;var i=e.getSeconds();return t+"-"+a+"-"+s+" "+r+":"+l+":"+(i=i<10?"0"+i:i)}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"select-times"},[a("el-radio-group",{attrs:{type:"success",size:"mini"},on:{change:e.change},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[a("el-radio-button",{attrs:{label:"1"}},[e._v("24小时")]),e._v(" "),a("el-radio-button",{attrs:{label:"2"}},[e._v("48小时")]),e._v(" "),a("el-radio-button",{attrs:{label:"3"}},[e._v("72小时")]),e._v(" "),a("el-radio-button",{attrs:{label:"4"}},[e._v("时间区段")])],1),e._v(" "),"4"==e.radio?a("el-date-picker",{staticStyle:{width:"200px","padding-bottom":"5px","padding-top":"5px","padding-left":"10px"},attrs:{size:"mini",type:"daterange","value-format":"yyyy-MM-dd","range-separator":"——","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.changeTimes},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}):e._e()],1)},staticRenderFns:[]};var p=a("VU/8")(c,d,!1,function(e){a("uvvq")},"data-v-8f2f203e",null).exports,u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-radio-group",{attrs:{size:"mini",fill:"#67C23A"},on:{change:e.change},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[a("el-radio-button",{attrs:{label:"2"}},[e._v("待处理")]),e._v(" "),a("el-radio-button",{attrs:{label:"0"}},[e._v("处理中")]),e._v(" "),a("el-radio-button",{attrs:{label:"1"}},[e._v("处理完成")]),e._v(" "),a("el-radio-button",{attrs:{label:"3"}},[e._v("无需处理")])],1)},staticRenderFns:[]};var v=a("VU/8")({name:"select-status",data:function(){return{radio:"2"}},methods:{change:function(){this.$emit("changeStatus",{status:this.radio})}}},u,!1,function(e){a("DUeF")},"data-v-d9904db8",null).exports,h=a("mF0L"),m={components:{SelectStatus:v,SelectTimes:p,SelectAlarmType:n,TimeFrame:l},name:"alarm-message",data:function(){return{isActive:!0,noActive:!1,start:"",end:"",type:"",radioType:"",disposalStatus:1,show:!1,tableData:[],title:"报警信息",flag:0,columns:[{name:"报警编号",prop:"id"},{name:"报警地址",prop:"address"},{name:"报警时间",prop:"alarmTime"},{name:"报警类型",prop:"category"},{name:"综合漏损指数",prop:"leakageIndex"},{name:"报警日水量",prop:"totalQuantity"},{name:"日量周同比增量",prop:"addTotal"},{name:"日量周同比增幅",prop:"addRangeTotal"},{name:"报警日最小量",prop:"minQuantity"},{name:"最小量周同比增量",prop:"addMin"},{name:"最小量周同比增幅",prop:"addRangeMin"},{name:"处理状态",prop:"disposalStatus"},{name:"地图定位",prop:"h"}],name:"status",value:"2"}},mounted:function(){},methods:{searchAlarm:function(){var e=this;this.show=!1;var t={pageNum:1,pageSize:1e4,category:this.type,disposalStatus:this.disposalStatus,startTime:this.start,endTime:this.end,name:this.name,value:this.value},a=[];this.$api.alarm.findAll(t).then(function(t){a=t.data.list,e.tableData=e.getTableData(a),e.show=!0})},getTableData:function(e){return e instanceof Array&&e.length>0&&e.forEach(function(e){switch(e.flag=!0,e.type=e.category,e.category){case"10":e.category="表具漏损";break;case"20":e.category="建筑漏损";break;case"30":e.category="DMA漏损";break;case"40":e.category="校区漏损";break;case"50":e.category="设备故障"}switch(e.disposalStatus){case"1":e.disposalStatus="待处理";break;case"2":e.disposalStatus="√";break;case"3":e.disposalStatus="×",e.flag=!1}e.addRangeTotal=e.addRangeTotal?parseFloat(e.addRangeTotal):"",e.addRangeMin=e.addRangeMin?parseFloat(e.addRangeMin):"",e.flag&&"50"!=e.category&&!e.status?(e.dispatcher=e.dispatcher?e.dispatcher:"待处理",e.disposaler=e.disposaler?e.disposaler:"待处理",e.disposalChecker=e.disposalChecker?e.disposalChecker:"待处理",e.transferer=e.transferer?e.transferer:"待处理",e.transferDisposaler=e.transferDisposaler?e.transferDisposaler:"待处理",e.checker=e.checker?e.checker:"待处理"):e.flag&&"50"==e.category&&!e.status?(e.dispatcher=e.dispatcher?e.dispatcher:"待处理",e.disposaler=e.disposaler?e.disposaler:"待处理",e.disposalChecker=e.disposalChecker?e.disposalChecker:"待处理",e.transferer="无",e.transferDisposaler="无",e.checker="无"):e.status?(e.dispatcher=e.dispatcher?e.dispatcher:"无",e.disposaler=e.disposaler?e.disposaler:"无",e.disposalChecker=e.disposalChecker?e.disposalChecker:"无",e.transferer=e.transferer?e.transferer:"无",e.transferDisposaler=e.transferDisposaler?e.transferDisposaler:"无",e.checker=e.checker?e.checker:"无"):(e.dispatcher="无",e.disposaler="无",e.disposalChecker="无",e.transferer="无",e.transferDisposaler="无",e.checker="无")}),e},changeTimes:function(e){var t=this.$route.params;0===this.flag&&(this.radioType=t.radio,this.type=t.type,this.flag=1),this.show=!1,this.start=e.start,this.end=e.end,this.searchAlarm()},changeType:function(e){this.type=e.type,this.show=!1,this.searchAlarm()},changeStatus:function(e){"2"===e.status?(this.show=!1,this.name="status",this.value=e.status,this.disposalStatus=1,this.searchAlarm()):"0"===e.status||"1"===e.status?(this.show=!1,this.name="status",this.value=e.status,this.disposalStatus=2,this.searchAlarm()):"3"===e.status&&(this.show=!1,this.name="status",this.value="1",this.disposalStatus=3,this.searchAlarm())},toWaterSupervision:function(e){var t="";switch(e.type){case"10":t="WaterUseSupervision";break;case"20":t="BuildingWaterSupervision";break;case"30":t="DMAWaterSupervision";break;case"40":t="CampusWaterSupervision";break;case"50":t="WaterUseSupervision"}this.$router.push({name:t,params:{id:Number(e.id.substring(1,4))}})},exportData:function(){Object(h.a)(this.columns,this.tableData,this.title)},link:function(e){var t=this;if("建筑漏损"==e.category){var a=void 0,s=void 0,r=void 0;this.$api.buildingInf.findOne(e.id.substring(1,4)).then(function(e){a=e.name,s=e.tag.substring(1,e.tag.length-1).split(",")[0],r=e.tag.substring(1,e.tag.length-1).split(",")[1],t.$router.push({path:"/BmapGL",query:{marker:{lng:s,lat:r},info:a}})})}else{var l=void 0,i=void 0,o=void 0;this.$api.waterMeterInf.findOne(e.id.substring(1,4)).then(function(e){l=e.name,i=e.tag.substring(1,e.tag.length-1).split(",")[0],o=e.tag.substring(1,e.tag.length-1).split(",")[1],t.$router.push({path:"/BmapGL",query:{marker:{lng:i,lat:o},info:l}})})}}}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"flex"},[a("div",{staticClass:"content body"},[a("div",{staticClass:"box box-solid"},[a("div",{staticClass:"box-header bg-aqua"},[e._v("\n        报警信息概况\n      ")]),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:!e.show,expression:"!show"}],staticClass:"box-body"},[a("div",{staticClass:"select-row"},[a("select-times",{on:{changeTimes:e.changeTimes}}),e._v(" "),a("select-alarm-type",{attrs:{type:e.radioType},on:{changeType:e.changeType}}),e._v(" "),a("select-status",{on:{changeStatus:e.changeStatus}}),e._v(" "),a("div",[a("el-button",{attrs:{type:"success",size:"small",icon:"el-icon-download"},on:{click:e.exportData}},[e._v("导出")])],1)],1),e._v(" "),a("div",{staticClass:"table-row"},[e.show?a("el-table",{attrs:{border:"",data:e.tableData,size:"mini",height:"100%","default-sort":{prop:"leakageIndex",order:"descending"}}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.childrenAlarm,function(t){return a("div",[a("el-form",{attrs:{inline:""}},[a("el-form-item",{staticClass:"redItem",attrs:{label:"报警编号："}},[a("span",{staticStyle:{color:"#A0A0A0"}},[e._v(e._s(t.id))])]),e._v(" "),a("el-form-item",{staticClass:"redItem",attrs:{label:"报警时间："}},[a("span",{staticStyle:{color:"#A0A0A0"}},[e._v(e._s(t.alarmTime))])]),e._v(" "),a("el-form-item",{staticClass:"redItem",attrs:{label:"地址："}},[a("span",{staticStyle:{color:"#A0A0A0"}},[e._v(e._s(t.address))])]),e._v(" "),a("el-form-item",{staticClass:"redItem",attrs:{label:"说明："}},[a("span",{staticStyle:{color:"#A0A0A0"}},[e._v(e._s(t.reportContent))])]),e._v(" "),a("el-form-item",{staticClass:"redItem",attrs:{label:"综合指数："}},[a("span",{staticStyle:{color:"#A0A0A0"}},[e._v(e._s(null==t.leakageIndex?"---":t.leakageIndex))])]),e._v(" "),a("el-form-item",{staticClass:"redItem",attrs:{label:"日用水量："}},[a("span",{staticStyle:{color:"#A0A0A0"}},[e._v(e._s(null==t.totalQuantity?"---":t.totalQuantity))])]),e._v(" "),a("el-form-item",{staticClass:"redItem",attrs:{label:"日量周同比增量："}},[a("span",{staticStyle:{color:"#A0A0A0"}},[e._v(e._s(null==t.addTotal?"---":t.addTotal))])]),e._v(" "),a("el-form-item",{staticClass:"redItem",attrs:{label:"日量周同比增幅："}},[a("span",{staticStyle:{color:"#A0A0A0"}},[e._v(e._s(null==t.addRangeTotal?"---":t.addRangeTotal))])]),e._v(" "),a("el-form-item",{staticClass:"redItem",attrs:{label:"日最小流量："}},[a("span",{staticStyle:{color:"#A0A0A0"}},[e._v(e._s(null==t.minQuantity?"---":t.minQuantity))])]),e._v(" "),a("el-form-item",{staticClass:"redItem",attrs:{label:"最小量周同比增量："}},[a("span",{staticStyle:{color:"#A0A0A0"}},[e._v(e._s(null==t.addMin?"---":t.addMin))])]),e._v(" "),a("el-form-item",{staticClass:"redItem",attrs:{label:"最小量周同比增幅："}},[a("span",{staticStyle:{color:"#A0A0A0"}},[e._v(e._s(null==t.addRangeMin?"---":t.addRangeMin))])])],1),e._v(" "),a("el-divider")],1)})}}],null,!1,1014618223)}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",label:"报警编号",prop:"id"}}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",label:"报警地址"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-link",{attrs:{type:"primary"},on:{click:function(a){return e.toWaterSupervision(t.row)}}},[e._v(e._s(t.row.address))])]}}],null,!1,946405062)}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",label:"报警时间",sortable:"",prop:"alarmTime"}}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",label:"报警类型",prop:"category"}}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",sortable:"",label:"综合漏损指数",width:"130",prop:"leakageIndex"}}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",sortable:"",label:"报警日水量",width:"130",prop:"totalQuantity"}}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",sortable:"",label:"日量周同比增量",width:"150",prop:"addTotal"}}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",sortable:"",label:"日量周同比增幅(%)",width:"170",prop:"addRangeTotal"}}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",sortable:"",width:"130",label:"报警日最小量",prop:"minQuantity"}}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",sortable:"",label:"最小量周同比增量",width:"170",prop:"addMin"}}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",sortable:"",label:"最小量周同比增幅(%)",width:"170",prop:"addRangeMin"}}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",label:"处理状态",width:"80",prop:"status"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{placement:"bottom",width:"600",trigger:"hover"}},[a("div",{staticClass:"box-title"},[a("div",[e._v("预处理")]),e._v(" "),a("div",[e._v("派单人")]),e._v(" "),a("div",[e._v("出单人")]),e._v(" "),a("div",[e._v("出单验收人")]),e._v(" "),a("div",[e._v("转派单人")]),e._v(" "),a("div",[e._v("转派出单人")]),e._v(" "),a("div",[e._v("回单人")])]),e._v(" "),a("div",{staticClass:"box-content"},[a("div",{class:["待处理"!=t.row.disposalStatus?"green":"yellow"]},[e._v(e._s(t.row.disposalStatus))]),e._v(" "),a("div",{class:["待处理"!=t.row.dispatcher?"green":"yellow"]},[e._v(e._s(t.row.dispatcher))]),e._v(" "),a("div",{class:["待处理"!=t.row.disposaler?"green":"yellow"]},[e._v(e._s(t.row.disposaler))]),e._v(" "),a("div",{class:["待处理"!=t.row.disposalChecker?"green":"yellow"]},[e._v(e._s(t.row.disposalChecker))]),e._v(" "),a("div",{class:["待处理"!=t.row.transferer?"green":"yellow"]},[e._v(e._s(t.row.transferer))]),e._v(" "),a("div",{class:["待处理"!=t.row.transferDisposaler?"green":"yellow"]},[e._v(e._s(t.row.transferDisposaler))]),e._v(" "),a("div",{class:["待处理"!=t.row.checker?"green":"yellow"]},[e._v(e._s(t.row.checker))])]),e._v(" "),a("el-link",{attrs:{slot:"reference",type:"primary"},slot:"reference"},[e._v(e._s(t.row.disposalStatus))])],1)]}}],null,!1,1384296429)}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"地图定位",width:"80",prop:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{disabled:new Array("校区漏损","DMA漏损").indexOf(t.row.category)>-1,type:"primary",size:"mini",icon:"el-icon-location"},on:{click:function(a){return e.link(t.row)}}})]}}],null,!1,1965714247)})],1):e._e()],1)])])])])},staticRenderFns:[]};var g=a("VU/8")(m,f,!1,function(e){a("FtYB")},"data-v-8e4280cc",null);t.default=g.exports},mTZ3:function(e,t){},qaaU:function(e,t){},uvvq:function(e,t){}});
//# sourceMappingURL=14.fa3ceb8cfc7cbb853a34.js.map