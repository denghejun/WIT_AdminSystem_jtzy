webpackJsonp([23],{"0Lq6":function(t,a){},SkTl:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("pFYg"),i=e.n(s),n=e("Xxa5"),r=e.n(n),o=e("exGp"),d=e.n(o),l=e("h9gA"),c=e("8pFS"),u={components:{MonitoringChart:e("UmIK").a},name:"water-charts-line",data:function(){return{current:[],last:[],time:[],show:!1}},mounted:function(){this.current=this.currentData,this.last=this.lastData,this.time=this.timeData,this.show=!0},props:{currentData:{type:Array},lastData:{type:Array},timeData:{type:Array},leakageData:{type:Object}},methods:{}},m={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"charts-line"},[e("div",{staticClass:"line-left"},[t.show?e("monitoring-chart",{attrs:{time:t.time,current:t.current,last:t.last}}):t._e()],1),t._v(" "),e("div",{staticClass:"line-right"},[e("div",[e("span",[t._v(t._s(t.leakageData.addTotal?t.leakageData.addTotal+"吨":"--"))]),e("br"),t._v(" "),e("span",[t._v("当日周同比增量")])]),t._v(" "),e("div",[e("span",[t._v(t._s(t.leakageData.addRangeTotal?t.leakageData.addRangeTotal:"--"))]),e("br"),t._v(" "),e("span",[t._v("当日周同比增幅")])]),t._v(" "),e("div",[e("span",[t._v(t._s(t.leakageData.addMin?t.leakageData.addMin+"吨":"--"))]),e("br"),t._v(" "),e("span",[t._v("当日周同比最小量增量")])]),t._v(" "),e("div",[e("span",[t._v(t._s(t.leakageData.addRangeMin?t.leakageData.addRangeMin:"--"))]),e("br"),t._v(" "),e("span",[t._v("当日周同比最小量增幅")])])])])},staticRenderFns:[]};var h=e("VU/8")(u,m,!1,function(t){e("0Lq6")},"data-v-6fbdeb48",null).exports,p=e("ae+z"),v={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"water-table"},[e("div",{staticClass:"first-column",style:{width:t.columnWidth}},[e("div",{staticClass:"first-column-row"},[t._v("时间")]),t._v(" "),e("div",{staticClass:"first-column-row"},[t._v("累计水量")]),t._v(" "),e("div",{staticClass:"first-column-row"},[t._v("当前水量")]),t._v(" "),e("div",{staticClass:"first-column-row"},[t._v("同期水量")]),t._v(" "),e("div",{staticClass:"first-column-row"},[t._v("同比增减")])]),t._v(" "),t._l(t.table,function(a,s){return e("div",{key:s,staticClass:"middle-column",style:{width:t.columnWidth}},[e("div",{staticClass:"middle-column-row"},[t._v(t._s(a.date))]),t._v(" "),e("div",{staticClass:"middle-column-row"},[t._v(t._s(a.total))]),t._v(" "),e("div",{staticClass:"middle-column-row"},[t._v(t._s(a.current))]),t._v(" "),e("div",{staticClass:"middle-column-row"},[t._v(t._s(a.samePeriod))]),t._v(" "),e("div",{staticClass:"middle-column-row"},[t._v(t._s(a.compare))])])}),t._v(" "),t._l(t.table.length<13?13-t.table.length:0,function(a){return e("div",{staticClass:"middle-column",style:{width:t.columnWidth}},[e("div",{staticClass:"middle-column-row"}),t._v(" "),e("div",{staticClass:"middle-column-row"}),t._v(" "),e("div",{staticClass:"middle-column-row"}),t._v(" "),e("div",{staticClass:"middle-column-row"}),t._v(" "),e("div",{staticClass:"middle-column-row"})])}),t._v(" "),e("div",{staticClass:"last-column",style:{width:t.columnWidth}},[e("div",{staticClass:"last-column-row"},[t._v("合计")]),t._v(" "),e("div",{staticClass:"last-column-row"},[t._v("--")]),t._v(" "),e("div",{staticClass:"last-column-row"},[t._v(t._s("NaN"==t.flowCount?"--":t.flowCount))]),t._v(" "),e("div",{staticClass:"last-column-row"},[t._v(t._s("NaN"==t.compareCount?"--":t.compareCount))]),t._v(" "),e("div",{staticClass:"last-column-row"},[t._v(t._s("NaN"==t.addCount?"--":t.addCount))])])],2)},staticRenderFns:[]};var f=function(t){e("seTR")},g=e("VU/8")(p.a,v,!1,f,"data-v-5710903f",null).exports,w=e("mF0L"),_={components:{WaterTable:g,WaterChartsLine:h,RadioSelect:c.a,SelectCampus:l.a},name:"campus-water-supervision",data:function(){return{regionId:1,start:"",end:"",compareStart:"",compareEnd:"",type:4,currentData:[],lastData:[],tableData:[],exportTable:[],columns:[{name:"日期",prop:"date"},{name:"累计水量",prop:"total"},{name:"当前水量",prop:"current"},{name:"同期水量",prop:"samePeriod"},{name:"同比水量",prop:"compare"}],title:"DMA用水监测数据",flowCount:"",compareCount:"",addCount:"",time:[],show:!1,showTable:!1,leakageIndexData:{}}},created:function(){var t=this.$route.params;t.id&&(this.regionId=t.id)},mounted:function(){this.getLeakageIndex()},methods:{link:function(t){this.regionId=t.id,this.getLeakageIndex(),this.findByType()},getLeakageIndex:function(){var t=this,a=void 0,e=new Date((new Date).getTime()-864e5),s=e.getFullYear(),i=e.getMonth()+1;i=i<10?"0"+i:i;var n=e.getDate();n=n<10?"0"+n:n;var r={waterregionid:this.regionId,time:s+"-"+i+"-"+n};this.$api.regionData.findLeakageIndex(r).then(function(e){console.log(e),a=e&&e.data?e.data:{},t.leakageIndexData=a})},searchByTimes:function(t){this.start=t.start,this.end=t.end,2!=t.type&&3!=t.type||(this.compareStart=t.compareStart,this.compareEnd=t.compareEnd),this.type=t.type,this.findByType()},findByType:function(){switch(this.type){case 1:this.findFlowByYear();break;case 2:this.findFlowByMonth();break;case 3:this.findFlowByDay();break;case 4:this.findFlowByHour()}},findFlowByYear:function(){var t=this;return d()(r.a.mark(function a(){var e,s,i;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t.show=!1,t.showTable=!1,e={pageNum:1,pageSize:1e3,waterregionid:t.regionId,startyy:t.start,endyy:t.end},a.next=5,t.$api.regionData.findTimesYearData(e);case 5:return s=!!((s=a.sent)&&s.data&&s.data.list&&s.data.list.length>0)&&s.data.list,a.next=9,t.$api.regionData.findTimesYearFlow(e);case 9:i=!!((i=a.sent)&&i.data&&i.data.list&&i.data.list.length>0)&&i.data.list,t.getChartsData(i,[]),t.getTableData(i,s,[]);case 13:case"end":return a.stop()}},a,t)}))()},findFlowByMonth:function(){var t=this;return d()(r.a.mark(function a(){var e,s,i,n;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t.show=!1,t.showTable=!1,e={pageNum:1,pageSize:1e3,waterregionid:t.regionId,starttime:t.start,endtime:t.end},a.next=5,t.$api.regionData.findTimesMonthData(e);case 5:return(s=!!((s=a.sent)&&s.data&&s.data.list&&s.data.list.length>0)&&s.data.list)&&s.shift(),a.next=10,t.$api.regionData.findTimesMonthFlow(e);case 10:return i=!!((i=a.sent)&&i.data&&i.data.list&&i.data.list.length>0)&&i.data.list,e.starttime=t.compareStart,e.endtime=t.compareEnd,a.next=16,t.$api.regionData.findTimesMonthFlow(e);case 16:n=!!((n=a.sent)&&n.data&&n.data.list&&n.data.list.length>0)&&n.data.list,t.getChartsData(i,n),t.getTableData(i,s,n);case 20:case"end":return a.stop()}},a,t)}))()},findFlowByDay:function(){var t=this;return d()(r.a.mark(function a(){var e,s,i,n;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t.show=!1,t.showTable=!1,e={pageNum:1,pageSize:1e3,waterregionid:t.regionId,starttime:t.start,endtime:t.end},a.next=5,t.$api.regionData.findTimesDayData(e);case 5:return(s=!!((s=a.sent)&&s.data&&s.data.list&&s.data.list.length>0)&&s.data.list)&&s.shift(),a.next=10,t.$api.regionData.findTimesDayFlow(e);case 10:return i=!!((i=a.sent)&&i.data&&i.data.list&&i.data.list.length>0)&&i.data.list,e.starttime=t.compareStart,e.endtime=t.compareEnd,a.next=16,t.$api.regionData.findTimesDayFlow(e);case 16:n=!!((n=a.sent)&&n.data&&n.data.list&&n.data.list.length>0)&&n.data.list,t.getChartsData(i,n),t.getTableData(i,s,n);case 20:case"end":return a.stop()}},a,t)}))()},findFlowByHour:function(){var t=this;return d()(r.a.mark(function a(){var e,s,i;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t.show=!1,t.showTable=!1,e={pageNum:1,pageSize:1e3,waterregionid:t.regionId,starttime:t.start,endtime:t.end},a.next=5,t.$api.regionData.findTimesHourData(e);case 5:return(s=!!((s=a.sent)&&s.data&&s.data.list&&s.data.list.length>0)&&s.data.list)&&s.shift(),a.next=10,t.$api.regionData.findTimesHourFlow(e);case 10:i=!!((i=a.sent)&&i.data&&i.data.list&&i.data.list.length>0)&&i.data.list,t.getChartsData(i,[]),t.getTableData(i,s,[]);case 14:case"end":return a.stop()}},a,t)}))()},getChartsData:function(t,a){var e=[],s=[],n=[];t&&1!=this.type&&4!=this.type?t.forEach(function(t,i){n.push(t.time),e.push(t.data),s.push(a[i]?a[i].data:null)}):"object"==(void 0===t?"undefined":i()(t))&&t.length>0&&t.forEach(function(t){n.push(t.time),e.push(t.data)}),this.currentData=e,this.lastData=s,this.time=n,this.show=!0},getTableData:function(t,a,e){var s=[],n=[],r=void 0,o=void 0,d=void 0,l=0,c=0,u=0;t&&1!=this.type&&4!=this.type?(t.forEach(function(t,i){a&&a[i]?a[i].readnumber.toFixed(1):0,r=t.data?t.data.toFixed(1):0,o=e&&e[i]?e[i].data.toFixed(1):0,d=Number((Number(r)-Number(o)).toFixed(1)),l+=Number(r),c+=Number(o),u+=Number(d),s.push({date:t.time,total:"--",current:r,samePeriod:o,compare:d}),n.push({date:t.time,total:"--",current:r,samePeriod:o,compare:d})}),n.push({date:"合计",total:"--",current:l,samePeriod:c,compare:u})):"object"==(void 0===t?"undefined":i()(t))&&t.length>0&&(t.forEach(function(t,e){a&&a[e]?a[e].readnumber.toFixed(1):0,r=t.data?t.data.toFixed(1):0,l+=Number(r),s.push({date:t.time,total:"--",current:r,samePeriod:"--",compare:"--"}),n.push({date:t.time,total:"--",current:r,samePeriod:"--",compare:"--"})}),c="--",u="--",n.push({date:"合计",total:"--",current:l,samePeriod:c,compare:u})),this.exportTable=n,this.tableData=s,this.flowCount="number"!=typeof parseFloat(l)?"--":Number(l).toFixed(1),this.compareCount="number"!=typeof parseFloat(c)?"--":Number(c).toFixed(1),this.addCount="number"!=typeof parseFloat(u)?"--":Number(u).toFixed(1),this.showTable=!0},exportData:function(){Object(w.a)(this.columns,this.exportTable,this.title)}}},b={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"flex"},[e("div",{staticClass:"content body"},[e("div",{staticClass:"water-charts"},[e("div",{staticClass:"box box-solid"},[e("div",{staticClass:"box-header bg-aqua"},[t._v("校区用水监测图表")]),t._v(" "),e("div",{staticClass:"box-body"},[e("div",{staticClass:"water-charts-select"},[e("select-campus",{staticClass:"select-campus",attrs:{regionId:t.regionId},on:{change:t.link}}),t._v(" "),e("radio-select",{staticClass:"radio-select",on:{searchByTimes:t.searchByTimes}})],1),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:!t.show,expression:"!show"}],staticClass:"water-charts-line"},[t.show?e("water-charts-line",{attrs:{currentData:t.currentData,lastData:t.lastData,timeData:t.time,leakageData:t.leakageIndexData}}):t._e()],1)])])]),t._v(" "),e("div",{staticClass:"water-table"},[e("div",{staticClass:"box box-solid"},[e("div",{staticClass:"box-header bg-aqua"},[t._v("校区用水监测数据"),e("el-button",{attrs:{size:"mini",type:"success",icon:"el-icon-download"},on:{click:t.exportData}},[t._v("导出")])],1),t._v(" "),e("div",{staticClass:"box-body"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:!t.showTable,expression:"!showTable"}],staticClass:"water-table-data"},[t.showTable?e("water-table",{attrs:{tableData:t.tableData,flowCount:t.flowCount,compareCount:t.compareCount,addCount:t.addCount}}):t._e()],1)])])])])])},staticRenderFns:[]};var C=e("VU/8")(_,b,!1,function(t){e("mF0t")},"data-v-14a44225",null);a.default=C.exports},"ae+z":function(t,a,e){"use strict";(function(t){a.a={name:"water-table",data:function(){return{table:[{date:"2020-01-01",total:"10000",current:"1000",samePeriod:"9999",compare:"999"},{date:"2020-01-02",total:"10000",current:"1000",samePeriod:"9999",compare:"999"},{date:"2020-01-03",total:"10000",current:"1000",samePeriod:"9999",compare:"999"},{date:"2020-01-04",total:"10000",current:"1000",samePeriod:"9999",compare:"999"},{date:"2020-01-05",total:"10000",current:"1000",samePeriod:"9999",compare:"999"},{date:"2020-01-06",total:"10000",current:"1000",samePeriod:"9999",compare:"999"}]}},mounted:function(){this.table=this.tableData},props:{tableData:{type:Array},flowCount:{type:String},compareCount:{type:String},addCount:{type:String}},computed:{columnWidth:function(){return(t(document).width()-200)/this.table.length+"px"}}}}).call(a,e("7t+N"))},mF0t:function(t,a){},seTR:function(t,a){}});
//# sourceMappingURL=23.7208cc329229f344f662.js.map