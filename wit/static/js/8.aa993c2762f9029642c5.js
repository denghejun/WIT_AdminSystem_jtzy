webpackJsonp([8],{"/RXW":function(t,e){},"7URT":function(t,e){},E39R:function(t,e){},IDIa:function(t,e,a){t.exports=a.p+"static/img/timg.f6d90a5.jpg"},Q4r1:function(t,e,a){"use strict";(function(t){e.a={name:"meter-table",data:function(){return{table:[]}},mounted:function(){this.table=this.tableData},props:{flowCount:{type:String},compareCount:{type:String},addCount:{type:String},tableData:{type:Array}},computed:{columnWidth:function(){return(t(document).width()-200)/this.table.length+"px"}}}}).call(e,a("7t+N"))},SJPb:function(t,e){},rxZD:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("Xxa5"),s=a.n(i),n=a("exGp"),r=a.n(n),o=a("pFYg"),l=a.n(o),d={name:"primary-meter",data:function(){return{meterData:[],changeSelectStyle:0,start:0,end:7,meters:[]}},mounted:function(){this.getAllMeters()},methods:{getAllMeters:function(){var t=this;return r()(s.a.mark(function e(){var a,i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$api.waterMeterInf.findALL();case 2:(a=e.sent)&&"object"==(void 0===a?"undefined":l()(a))&&a.length>0&&(i=a.filter(function(t){return"一级表"==t.remark})),t.meterData=i,t.meters=t.meterData.slice(t.start,t.end),t.init();case 7:case"end":return e.stop()}},e,t)}))()},init:function(){var t=this.meterData[0];this.changeSelectStyle=t.snumber;var e={name:t.name,id:t.id};this.$emit("init",e)},link:function(t,e){this.changeSelectStyle=t.snumber;var a={name:t.name,id:t.id};this.$emit("link",a)},toLeft:function(){this.start-=7,this.end-=7,this.meters=this.meterData.slice(this.start,this.end)},toRight:function(){this.start+=7,this.end+=7,this.meters=this.meterData.slice(this.start,this.end)}}},c={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"meters"},[i("div",{staticClass:"left"},[i("el-button",{attrs:{type:"success",size:"small",disabled:0==t.start,circle:""},on:{click:t.toLeft}},[t._v(" << ")])],1),t._v(" "),i("div",{class:t.end>=t.meterData.length?"middle-left":"middle"},t._l(t.meters,function(e,s){return i("div",{key:s,staticClass:"meter",class:{changeStyle:t.changeSelectStyle==e.snumber},on:{click:function(a){return t.link(e,s)}}},[i("img",{staticClass:"img",attrs:{src:a("IDIa"),alt:""}}),t._v(" "),i("div",{staticClass:"title"},[t._v(t._s(e.name))]),t._v(" "),i("div",{staticClass:"number"},[t._v(t._s(e.snumber))]),t._v(" "),i("div",{staticClass:"is-online"},[i("div",{class:e.isonline?"green":"red"}),t._v("\n        "+t._s(e.isonline?"在线":"不在线")+"\n      ")])])}),0),t._v(" "),i("div",{staticClass:"right"},[i("el-button",{attrs:{type:"success",size:"small",disabled:t.end>=t.meterData.length,circle:""},on:{click:t.toRight}},[t._v(" >> ")])],1)])},staticRenderFns:[]};var m=a("VU/8")(d,c,!1,function(t){a("/RXW")},"data-v-28aa1409",null).exports,u=a("8pFS"),h=a("zQgQ"),p=a("Q4r1"),v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"water-table"},[a("div",{staticClass:"first-column",style:{width:t.columnWidth}},[a("div",{staticClass:"first-column-row"},[t._v("时间")]),t._v(" "),a("div",{staticClass:"first-column-row"},[t._v("累计水量")]),t._v(" "),a("div",{staticClass:"first-column-row"},[t._v("当前水量")]),t._v(" "),a("div",{staticClass:"first-column-row"},[t._v("同期水量")]),t._v(" "),a("div",{staticClass:"first-column-row"},[t._v("同比增减")])]),t._v(" "),t._l(t.table,function(e,i){return a("div",{key:i,staticClass:"middle-column",style:{width:t.columnWidth}},[a("div",{staticClass:"middle-column-row"},[t._v(t._s(e.date))]),t._v(" "),a("div",{staticClass:"middle-column-row"},[t._v(t._s(e.total))]),t._v(" "),a("div",{staticClass:"middle-column-row"},[t._v(t._s(e.current))]),t._v(" "),a("div",{staticClass:"middle-column-row"},[t._v(t._s(e.samePeriod))]),t._v(" "),a("div",{staticClass:"middle-column-row"},[t._v(t._s(e.compare))])])}),t._v(" "),t._l(t.table.length<13?13-t.table.length:0,function(e){return t.table.length<13?a("div",{staticClass:"middle-column",style:{width:t.columnWidth}},[a("div",{staticClass:"middle-column-row"}),t._v(" "),a("div",{staticClass:"middle-column-row"}),t._v(" "),a("div",{staticClass:"middle-column-row"}),t._v(" "),a("div",{staticClass:"middle-column-row"}),t._v(" "),a("div",{staticClass:"middle-column-row"})]):t._e()}),t._v(" "),a("div",{staticClass:"last-column",style:{width:t.columnWidth}},[a("div",{staticClass:"last-column-row"},[t._v("合计")]),t._v(" "),a("div",{staticClass:"last-column-row"},[t._v("--")]),t._v(" "),a("div",{staticClass:"last-column-row"},[t._v(t._s(t.flowCount))]),t._v(" "),a("div",{staticClass:"last-column-row"},[t._v(t._s(t.compareCount))]),t._v(" "),a("div",{staticClass:"last-column-row"},[t._v(t._s(t.addCount))])])],2)},staticRenderFns:[]};var f=function(t){a("E39R")},g=a("VU/8")(p.a,v,!1,f,"data-v-78e7f174",null).exports,w=a("mF0L"),y={components:{MeterTable:g,BarChartS:h.a,RadioSelect:u.a,PrimaryMeter:m},name:"primary-meter-supervision",data:function(){return{meterName:"",meterId:0,start:"",end:"",compareStart:"",compareEnd:"",xData:[],yData:[],show:!1,showTable:!1,xName:"",title:"",type:4,tableData:[],columns:[{name:"日期",prop:"date"},{name:"累计水量",prop:"total"},{name:"当前水量",prop:"current"},{name:"同期水量",prop:"samePeriod"},{name:"同比水量",prop:"compare"}],exportTable:[],flowCount:0,compareCount:0,addCount:0}},mounted:function(){},methods:{link:function(t){this.meterName=t.name,this.meterId=t.id,this.findByType()},init:function(t){this.meterName=t.name,this.meterId=t.id},searchByTimes:function(t){this.start=t.start,this.end=t.end,2!=t.type&&3!=t.type||(this.compareStart=t.compareStart,this.compareEnd=t.compareEnd),this.type=t.type,this.findByType()},findByType:function(){switch(this.type){case 1:this.findFlowByYear();break;case 2:this.findFlowByMonth();break;case 3:this.findFlowByDay();break;case 4:this.findFlowByHour()}},findFlowByYear:function(){var t=this;return r()(s.a.mark(function e(){var a,i,n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.show=!1,t.showTable=!1,a={pageNum:1,pageSize:1e3,watermeterid:t.meterId,startyy:t.start,endyy:t.end},e.next=5,t.$api.waterMeterData.findTimesYearData(a);case 5:return i=!!((i=e.sent)&&i.data&&i.data.list&&i.data.list.length>0)&&i.data.list,e.next=9,t.$api.waterMeterData.findTimesYearFlow(a);case 9:n=!!((n=e.sent)&&n.data&&n.data.list&&n.data.list.length>0)&&n.data.list,t.title=n[0].time+"至"+n[n.length-1].time+"年水量图表",t.xName="年",t.getChartsData(n),t.getTableData(n,i,[]);case 15:case"end":return e.stop()}},e,t)}))()},findFlowByMonth:function(){var t=this;return r()(s.a.mark(function e(){var a,i,n,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.show=!1,t.showTable=!1,a={pageNum:1,pageSize:1e3,watermeterid:t.meterId,starttime:t.start,endtime:t.end},e.next=5,t.$api.waterMeterData.findTimesMonthData(a);case 5:return(i=!!((i=e.sent)&&i.data&&i.data.list&&i.data.list.length>0)&&i.data.list)&&i.shift(),e.next=10,t.$api.waterMeterData.findTimesMonthFlow(a);case 10:return n=!!((n=e.sent)&&n.data&&n.data.list&&n.data.list.length>0)&&n.data.list,a.starttime=t.compareStart,a.endtime=t.compareEnd,e.next=16,t.$api.waterMeterData.findTimesMonthFlow(a);case 16:r=!!((r=e.sent)&&r.data&&r.data.list&&r.data.list.length>0)&&r.data.list,t.title=n[0].time+"至"+n[n.length-1].time+"水量图表",t.xName="月",t.getChartsData(n),t.getTableData(n,i,r);case 22:case"end":return e.stop()}},e,t)}))()},findFlowByDay:function(){var t=this;return r()(s.a.mark(function e(){var a,i,n,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.show=!1,t.showTable=!1,a={pageNum:1,pageSize:1e3,watermeterid:t.meterId,starttime:t.start,endtime:t.end},e.next=5,t.$api.waterMeterData.findTimesDayData(a);case 5:return(i=!!((i=e.sent)&&i.data&&i.data.list&&i.data.list.length>0)&&i.data.list)&&i.shift(),e.next=10,t.$api.waterMeterData.findTimesDayFlow(a);case 10:return n=!!((n=e.sent)&&n.data&&n.data.list&&n.data.list.length>0)&&n.data.list,a.starttime=t.compareStart,a.endtime=t.compareEnd,e.next=16,t.$api.waterMeterData.findTimesDayFlow(a);case 16:r=!!((r=e.sent)&&r.data&&r.data.list&&r.data.list.length>0)&&r.data.list,t.title=n[0].time+"至"+n[n.length-1].time+"水量图表",t.xName="日",t.getChartsData(n),t.getTableData(n,i,r);case 23:case"end":return e.stop()}},e,t)}))()},findFlowByHour:function(){var t=this;return r()(s.a.mark(function e(){var a,i,n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.show=!1,t.showTable=!1,a={pageNum:1,pageSize:1e3,watermeterid:t.meterId,starttime:t.start,endtime:t.end},e.next=5,t.$api.waterMeterData.findTimesHourData(a);case 5:return(i=!!((i=e.sent)&&i.data&&i.data.list&&i.data.list.length>0)&&i.data.list)&&i.shift(),e.next=10,t.$api.waterMeterData.findTimesHourFlow(a);case 10:n=!!((n=e.sent)&&n.data&&n.data.list&&n.data.list.length>0)&&n.data.list,t.title=n[0].time+"至"+n[n.length-1].time+"水量图表",t.xName="时",t.getChartsData(n),t.getTableData(n,i,[]);case 16:case"end":return e.stop()}},e,t)}))()},getTableData:function(t,e,a){var i=[],s=[],n=void 0,r=void 0,o=void 0,l=void 0,d=0,c=0,m=0;t&&1!=this.type&&4!=this.type?(t.forEach(function(t,u){o=e&&e[u]?e[u].readnumber.toFixed(1):0,n=t.data?t.data.toFixed(1):0,r=a&&a[u]?a[u].data.toFixed(1):0,l=Number((Number(n)-Number(r)).toFixed(1)),d+=Number(n),c+=Number(r),m+=Number(l),i.push({date:t.time,total:o,current:n,samePeriod:r,compare:l}),s.push({date:t.time,total:o,current:n,samePeriod:r,compare:l})}),s.push({date:"合计",total:"--",current:d,samePeriod:c,compare:m}),this.exportTable=s,this.tableData=i,this.flowCount=d.toFixed(1),this.compareCount=c.toFixed(1),this.addCount=m.toFixed(1)):(t.forEach(function(t,a){o=e&&e[a]?e[a].readnumber.toFixed(1):0,n=t.data?t.data.toFixed(1):0,d+=Number(n),i.push({date:t.time,total:o,current:n,samePeriod:"--",compare:"--"}),s.push({date:t.time,total:o,current:n,samePeriod:"--",compare:"--"})}),c="--",m="--",s.push({date:"合计",total:"--",current:d,samePeriod:c,compare:m}),this.exportTable=s,this.tableData=i,this.flowCount=d.toFixed(1),this.compareCount=c,this.addCount=m),this.showTable=!0},getChartsData:function(t){var e=[],a=[];t&&t.forEach(function(t){e.push(t.time),a.push({value:t.data<0?-1*t.data:t.data,flag:t.data<0})}),this.xData=e,this.yData=a,this.show=!0},exportData:function(){Object(w.a)(this.columns,this.exportTable,this.title)}}},b={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"flex"},[a("div",{staticClass:"content body"},[a("div",{staticClass:"primary-meter box box-solid"},[a("div",{staticClass:"box-header bg-aqua"},[t._v("一级水表监管")]),t._v(" "),a("div",{staticClass:"box-body"},[a("primary-meter",{on:{link:t.link,init:t.init}})],1)]),t._v(" "),a("div",{staticClass:"meter-data box box-solid"},[a("div",{staticClass:"box-header bg-aqua"},[t._v(t._s(t.meterName)+"监测数据图表\n        "),a("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-download"},on:{click:t.exportData}},[t._v("导出")])],1),t._v(" "),a("div",{staticClass:"box-body"},[0!=t.meterId?a("radio-select",{staticClass:"radio-select",on:{searchByTimes:t.searchByTimes}}):t._e(),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:!t.show,expression:"!show"}],staticClass:"meter-chart"},[t.show?a("bar-chart-s",{attrs:{xData:t.xData,yData:t.yData,typeName:t.xName,title:t.title}}):t._e()],1),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:!t.showTable,expression:"!showTable"}],staticClass:"meter-table"},[t.showTable?a("meter-table",{attrs:{tableData:t.tableData,flowCount:t.flowCount,compareCount:t.compareCount,addCount:t.addCount}}):t._e()],1)],1)])])])},staticRenderFns:[]};var x=a("VU/8")(y,b,!1,function(t){a("SJPb")},"data-v-9e94e6ac",null);e.default=x.exports},zQgQ:function(t,e,a){"use strict";var i=a("sE1n");a("XLwt"),a("SwK5");a("jjRC");var s={components:{"v-chart":i.a},name:"bar-chart-s",mounted:function(){this.orgOptions.title.text=this.title,this.orgOptions.xAxis.name=this.typeName,this.orgOptions.xAxis.data=this.xData,this.orgOptions.series[0].data=this.yData},data:function(){return{orgOptions:{title:{text:"",x:"center",textStyle:{fontStyle:"bolder"}},xAxis:{name:"时",type:"category",data:[]},grid:{left:"2%",right:"3%",bottom:"3%",containLabel:!0},legend:{data:[""]},tooltip:{trigger:"axis"},yAxis:{name:"吨",type:"value"},toolbox:{show:!0,right:30,feature:{magicType:{type:["line","bar"]},saveAsImage:{}}},series:[{data:[],type:"bar",name:"用水量(吨)",smooth:!0,itemStyle:{normal:{color:function(t){var e=["#5B9BD5","#92D03C","#DC143C","#ADFF2F"],a=void 0,i=void 0,s=void 0,n=void 0;if(4==t.name.length)a=t.dataIndex%2==0;else if(7==t.name.length)a=Number(t.name.split("-")[0])%2==0;else if(10==t.name.length)a=Number(t.name.split("-")[1])%2==0;else{i=Number(t.name.split(" ")[0].split("-")[2]),s=Number(t.name.split(" ")[0].split("-")[1]),a=i%2==0;n=Number(t.name.split(" ")[0].split("-")[0])%4==0?[1,2,3,5,7,8,10,12].indexOf(s)>-1&&(2==s&&29==i||31==i):[1,3,5,7,8,10,12].indexOf(s)>-1&&31==i}return!a||t.data.flag||n?t.data.flag&&!n?e[2]:n?e[3]:e[1]:e[0]}}}}]}}},props:{toHeight:{type:String,default:"100%"},toWidth:{type:String,default:"100%"},xData:{type:Array},yData:{type:Array},typeName:{type:String,default:"时"},title:{type:String},yName:{type:String,default:"吨"},xRotate:{type:Number},color:{type:String}},watch:{title:{handler:function(t,e){this.orgOptions.title.text=t}},typeName:{handler:function(t,e){this.orgOptions.xAxis.name=t},deep:!0},xData:{handler:function(t,e){this.orgOptions.xAxis.data=t},deep:!0},yData:{handler:function(t,e){this.orgOptions.series[0].data=t},deep:!0},yName:{handler:function(t,e){this.orgOptions.yAxis.name=t}}}},n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{height:"100%"}},[e("v-chart",{style:{height:this.toHeight,width:this.toWidth},attrs:{theme:"shine",options:this.orgOptions}})],1)},staticRenderFns:[]};var r=a("VU/8")(s,n,!1,function(t){a("7URT")},"data-v-033483f8",null);e.a=r.exports}});
//# sourceMappingURL=8.aa993c2762f9029642c5.js.map