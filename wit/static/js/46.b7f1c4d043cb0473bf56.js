webpackJsonp([46],{PnVm:function(e,t){},d3kW:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={components:{SelectBuilding:i("kWzz").a},name:"building-picture",data:function(){return{imageData:[],buildingId:138,tableData:[]}},mounted:function(){this.getBuildingPic()},methods:{handleChange:function(e){this.fileData=e.raw},uploadFiles:function(){var e=this,t=this,i=new FormData;i.append("picFile",t.fileData),i.append("buildingid",t.buildingId),t.$api.buildingPic.addOne(i).then(function(i){200==i.status?(e.$message({type:"success",message:"图片上传成功！"}),t.getBuildingPic()):e.$message({type:"error",message:"您的账号权限不足！"})})},getBuildingPic:function(){var e=this,t={buildingid:this.buildingId};this.$api.buildingPic.findById(t).then(function(t){null==t||""==t?e.imageData=[]:(t.forEach(function(e){e.image="data:image/jpg;base64,"+e.image}),e.imageData=t)})},change:function(e){this.buildingId=e.id,this.getBuildingPic()},handleDelete:function(e,t){var i=this;this.$confirm("此操作将永久删除该内容, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){i.$api.buildingPic.deleteOne(t.id).then(function(e){"ok"==e.msg?(i.$message({type:"success",message:"删除成功！"}),i.getBuildingPic()):i.$message({type:"error",message:"您的账号权限不足！"})}).catch(function(){i.$message({type:"info",message:"删除失败！"})})}).catch(function(){i.$message({type:"info",message:"已取消删除"})})}}},a={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"flex"},[i("div",{staticClass:"content"},[i("div",{staticClass:"box"},[i("div",{staticClass:"box-header bg-aqua"},[e._v("建筑照片管理")]),e._v(" "),i("div",{staticClass:"box-body"},[i("div",{staticStyle:{display:"inline-flex","flex-flow":"row","margin-bottom":"10px"}},[i("select-building",{attrs:{buildingId:e.buildingId},on:{change:e.change}}),e._v("\n           \n          "),i("el-upload",{attrs:{"on-change":e.handleChange,"auto-upload":!0,"http-request":e.uploadFiles,accept:"image/jpg,image/jpeg,image/png",action:""}},[i("el-button",{attrs:{size:"mini",type:"primary"}},[e._v("图片上传")])],1)],1),e._v(" "),i("el-table",{attrs:{data:e.imageData,size:"mini",border:"",stripe:""}},[i("el-table-column",{attrs:{type:"index",label:"序号"}}),e._v(" "),i("el-table-column",{attrs:{width:"200px",prop:"buildingname",label:"建筑名称"}}),e._v(" "),i("el-table-column",{attrs:{prop:"remark",label:"备注"}}),e._v(" "),i("el-table-column",{attrs:{width:"600px",label:"照片"},scopedSlots:e._u([{key:"default",fn:function(e){return[i("img",{staticClass:"image_type",attrs:{src:e.row.image}})]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作",width:"200px",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini",icon:"el-icon-delete",type:"danger"},on:{click:function(i){return e.handleDelete(t.$index,t.row)}}},[e._v("删除照片")])]}}])})],1)],1)])])])},staticRenderFns:[]};var s=i("VU/8")(n,a,!1,function(e){i("PnVm")},"data-v-02318844",null);t.default=s.exports}});
//# sourceMappingURL=46.b7f1c4d043cb0473bf56.js.map